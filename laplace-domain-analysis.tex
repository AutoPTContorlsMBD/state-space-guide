\chapter{Laplace domain analysis}

\section{Locations of poles and zeroes}

The locations of the closed-loop poles in the complex plane determine the
stability of the \gls{system}. Each pole represents a frequency mode of the
\gls{system}, and their location determines how much of each response is induced
for a given input frequency. Figure \ref{fig:system_response_poles} shows the
time domain responses for transfer functions with various pole locations. They
all have an initial condition of one.

\begin{figure}[H]
  \centering

  \begin{tikzpicture}[auto, >=latex']
    % \draw [help lines] (-4,-2) grid (4,4);

    % Draw main axes
    \draw[->] (-4.2,0) -- (4.2,0) node[below] {\small Re($\sigma$)};
    \draw[->] (0,-2) -- (0,4.2) node[right] {\small Im($j\omega$)};

    % Stable: e^-1.75t * cos(1.75wt) (80/3*w for readability)
    \drawtimeplot{-2.125cm}{2.5cm}{0.125cm}{0.44375cm}{
      exp(-1.75 * \x) * cos(80/3 * 1.75 * deg(\x))}
    \drawpole{-1.75cm}{1.75cm}

    % Stable: e^-2.5t
    \drawtimeplot{-2.25cm}{0.75cm}{0.125cm}{0.125cm}{exp(-2 * \x)}
    \drawpole{-2cm}{0cm}

    % Stable: e^-t
    \drawtimeplot{-1.125cm}{-0.75cm}{0.125cm}{0.125cm}{exp(-\x)}
    \drawpole{-1cm}{0cm}

    % Marginally stable: cos(wt) (80/3*w for readability)
    \drawtimeplot{-0.75cm}{1.125cm}{0.125cm}{0.44375cm}{cos(80/3 * deg(\x))}
    \drawpole{0cm}{1cm}

    % Marginally stable cos(2wt) (80/3*w for readability)
    \drawtimeplot{0cm}{2.75cm}{0.125cm}{0.44375cm}{cos(80/3 * 2 * deg(\x))}
    \drawpole{0cm}{2cm}

    % Integrator
    \drawtimeplot{0.25cm}{-0.75cm}{0.125cm}{0.125cm}{1}
    \drawpole{0cm}{0cm}

    % Unstable: e^t
    \drawtimeplot{1.125cm}{0.75cm}{0.125cm}{0.125cm}{exp(\x)}
    \drawpole{1cm}{0cm}

    % Unstable: e^2t
    \drawtimeplot{2.25cm}{-0.75cm}{0.125cm}{0.125cm}{exp(2 * \x)}
    \drawpole{2cm}{0cm}

    % Unstable: e^0.75t * cos(1.75wt) (80/3*w for readability)
    \drawtimeplot{1.5cm}{2.25cm}{0.125cm}{0.44375cm}{
      exp(0.75 * \x) * cos(80/3 * 1.75 * deg(\x))}
    \drawpole{0.75cm}{1.75cm}

    % LHP and RHP labels
    \draw (-3.5,1.5) node {LHP};
    \draw (3.5,1.5) node {RHP};

    % Stable and unstable labels
    \draw (-2.5,3.5) node {\small Stable};
    \draw (2.5,3.5) node {\small Unstable};
  \end{tikzpicture}

  \caption{Time domain system response vs pole location}
  \label{fig:system_response_poles}
\end{figure}

\begin{table}
  \renewcommand{\arraystretch}{1.5}
  \centering
  \begin{tabular}{|ll|}
    \hline
    \rowcolor{headingbg}
    \textbf{Location} & \textbf{Stability} \\
    \hline
    Left-Half-plane (LHP) & Stable \\
    Imaginary axis & Marginally stable \\
    Right Half-plane (RHP) & Unstable \\
    \hline
  \end{tabular}
  \caption{Pole location and stabilty}
  \label{tab:pole_locations}
\end{table}

When a system is stable, its output may oscillate but it converges to
steady-state. When a system is marginally stable, its output oscillates at a
constant amplitude forever. When a system is unstable, its output grows without
bound.

\section{Root locus}

In closed-loop, the poles and zeroes can be moved around by the chosen
controller. The root locus shows where they will go as the controller gain is
increased. Figure \ref{fig:poster_rlocus} shows the root locus of the transfer
function from equation (\ref{eq:transfer_func}).

\begin{figure}[H]
  \def\svgwidth{\linewidth}
  \input{root_locus.pdf_tex}
  \caption{Root locus of equation (\ref{eq:transfer_func}). See snippet
    \ref{lst:poster_rlocus}.}
  \label{fig:poster_rlocus}
\end{figure}

\begin{snippet}
  \caption{Root locus in Python}
  \label{lst:poster_rlocus}
  \includecode[Python]{code/root_locus.py}
\end{snippet}

As the controller gain increases, the poles move toward the zeroes. In this
case, the \gls{system} eventually becomes unstable.

\textbf{Note:} If poles are much farther left in the LHP than the typical
\gls{system} dynamics exhibit, they can be considered negligible. Every
\gls{system} has some form of unmodeled high frequency, nonlinear dynamics, but
they can be safely ignored depending on the operating regime.

\subsection{Non-minimum phase zeroes}

While poles in the RHP are unstable, the same is not true for zeroes. They can
be characterized by the \gls{system} initially moving in the wrong direction
before heading toward the \gls{reference}. Since the poles always move toward
the zeroes, zeroes impose a "speed limit" on the \gls{system} response because
it takes a finite amount of time to move the wrong direction, then change
directions.

One example is bicycle steering. Try riding a bicycle without holding the handle
bars, then poke the right handle; the bicycle turns right.

\section{Gain margin and phase margin} \label{sec:gain-phase-margin}

One generally needs to learn about Bode plots and Nyquist plots to truly
understand gain and phase margin and their origins, but those plots are large
topics unto themselves. Since we won't be using either of these plots for
controller design, we'll just cover what gain and phase margin are in a general
sense and how they are used.

Gain margin and phase margin are two metrics for measuring a system's relative
stability. Gain and phase margin are the amounts by which the closed-loop gain
and phase can be varied respectively before the system becomes unstable. In a
sense, they are safety margins for when unmodeled dynamics affect the system
response.

For a more thorough explanation of gain and phase margin, watch Brian Douglas's
video on them \cite{bib:gain_phase_margin}. He has other videos too on classical
control methods like Bode and Nyquist plots that I recommend.
