\documentclass[11pt]{book}

\usepackage{amsmath,amssymb,amsthm}
\DeclareMathOperator{\tr}{tr}
\usepackage[english]{babel} % English language/hyphenation
\usepackage{bm}
\usepackage{booktabs} % For nicer horizontal rules in tables
\usepackage{calc} % For simpler calculation in spacing index letter headings
\usepackage{colortbl} % For colored table rows
\usepackage{datetime} % For the generated date
\usepackage{fancyhdr} % For the headers
\usepackage{float} % For preventing figure floating
\usepackage[bottom]{footmisc} % For putting footnotes at the bottom of the page
\usepackage{gensymb} % For degree symbol
\usepackage[top=3cm,bottom=3cm,left=3cm,right=3cm,headsep=10pt,a4paper]{geometry}
\usepackage{graphicx} % For including pictures
\graphicspath{{figs/}} % Specifies the directory where pictures are stored
\usepackage{imakeidx} % For \indexsetup command to fix index heading style
\usepackage{listings}
\usepackage{mathrsfs}
\DeclareMathAlphabet{\mathscrbf}{OMS}{cmsy}{m}{n}
\usepackage{makeidx}
\usepackage{parskip}
\usepackage{placeins} % For FloatBarrier command
\usepackage{subcaption}
\usepackage{tabulary}
\usepackage{tikz}
\usepackage{titletoc}

\usepackage{enumitem} % Customize lists
\setlist{nolistsep} % Reduce spacing between bullet points and numbered lists

% Font setup
\usepackage{microtype} % Slightly tweak font spacing for aesthetics
\usepackage[T1]{fontenc} % Use 8-bit encoding that has 256 glyphs

% Set main fonts
\usepackage[no-math]{fontspec}
\setmainfont[Path=./fonts/,
             BoldFont=FreeSerifBold.ttf,
             ItalicFont=FreeSerifItalic.ttf,
             BoldItalicFont=FreeSerifBoldItalic.ttf]{FreeSerif.ttf}
\setsansfont[Path=./fonts/,
             BoldFont=FreeSansBold.ttf,
             ItalicFont=FreeSansOblique.ttf,
             BoldItalicFont=FreeSansBoldOblique.ttf]{FreeSans.ttf}
\renewcommand{\familydefault}{\rmdefault}

% Bibliography setup
\usepackage[style=numeric,citestyle=numeric,sorting=nyt,sortcites=true,autopunct=true,autolang=hyphen,hyperref=true,abbreviate=false,backref=true,backend=biber]{biblatex}
\addbibresource{state-space-guide.bib}
\defbibheading{bibempty}{}

% Index setup
\makeindex
\indexsetup{othercode={\fancyhead[LO,RE]{\sffamily\bfseries Index}}}

\usepackage{hyperref}
\hypersetup{hidelinks,colorlinks=false,breaklinks=true,bookmarksopen=false,
  pdftitle={Practical Guide to State-space Control},pdfauthor={Tyler Veness}}

% Load after hyperref
\usepackage[nopostdot,style=index,nonumberlist]{glossaries}

\input{preamble/styles}
\input{preamble/macros}
\input{preamble/config}
\input{preamble/layout}

\input{glossary}
\makeglossaries

\begin{document}
% \usechapterimagefalse
\frontmatter
\input{front}
\input{preface}

\mainmatter
\input{notes-to-the-reader}
\input{introduction}
\part{Classical control}
\input{control-system-basics}
\input{pid-controllers}
\input{laplace-domain-analysis}
\part{Modern control}
\input{linear-algebra}
\input{ss-representation}
\input{ss-controllers}
\input{digital-control}
\input{stochastic-control-theory}
\part{Controls design/implementation}
\input{application-notes}
\input{ss-model-examples}

% Appendices
\part{Appendices}
\appendix

% Appendix text font settings
\renewcommand{\chaptermark}[1]{\markboth{\sffamily\normalsize\bfseries\appendixname\ \thechapter.\ #1}{}}
\chapterimage{appendices.jpg}{Sunset in an airplane over New Mexico}
\input{appendices/simplifying-block-diagrams}
\input{appendices/installing-python-control}
\input{appendices/ss-canonical-forms}
\input{appendices/nonlinear-control}
\input{appendices/derivations}

% Back matter
\renewcommand{\chaptermark}[1]{\markboth{\sffamily\normalsize\bfseries #1}{}}
\input{back}
\end{document}
